<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>The this keyword. | Dustin John Pfister at github pages</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Every javaScript developer that runs a blog ends up writing at least one post on the this keyword. So I thought I should get this one out of the way quick, so I can get to writing about more obscure a">
<meta property="og:type" content="article">
<meta property="og:title" content="The this keyword.">
<meta property="og:url" content="https://dustinpfister.github.io/2017/04/14/js-this-keyword/index.html">
<meta property="og:site_name" content="Dustin John Pfister at github pages">
<meta property="og:description" content="Every javaScript developer that runs a blog ends up writing at least one post on the this keyword. So I thought I should get this one out of the way quick, so I can get to writing about more obscure a">
<meta property="og:updated_time" content="2017-04-14T15:01:24.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The this keyword.">
<meta name="twitter:description" content="Every javaScript developer that runs a blog ends up writing at least one post on the this keyword. So I thought I should get this one out of the way quick, so I can get to writing about more obscure a">
  
    <link rel="alternate" href="/atom.xml" title="Dustin John Pfister at github pages" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83195184-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <!-- structured data set in structured-data.ejs -->
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Person",
    "email": "distin.pfister@gmail.com",
    "givenName": "Dustin",
    "familyName" : "Pfister",
    "additionalName": "John",
    "name": "Dustin John Pfister",
    "gender": "Male"
}
</script>
<!-- end structured data -->
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <!-- added the image-->
        <div class="selfimage"></div>
        <!--<a href="/" id="logo">Dustin John Pfister at github pages</a>-->
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/games">Games</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <!-- removed rss link-->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dustinpfister.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article itemscope itemtype="http://schema.org/Blog" id="post-js-this-keyword" class="article article-type-post" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/14/js-this-keyword/" class="article-date"> Published:
  <time datetime="2017-04-14T14:45:25.000Z" itemprop="datePublished">2017-04-14</time>
</a>

    <!-- other info (dustin) -->
    <a href="/2017/04/14/js-this-keyword/" class="article-date"> Modified:
  <time datetime="2017-04-14T15:01:24.000Z" itemprop="dateModified">2017-04-14</time>
</a>

    <span class="article-date">V1.1</span>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      The this keyword.
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="text">
      
        <p>Every javaScript developer that runs a blog ends up writing at least one post on the this keyword. So I thought I should get this one out of the way quick, so I can get to writing about more obscure and uncovered aspects of the JavaScript ecosystem, as there is all ready a great many posts on this subject. Still if I am going to make yet another one, I should be able to do a descent job on it considering there is so much great content on it out on the Internet all ready, so here we go.</p>
<a id="more"></a>
<h2 id="this-is-dynamic"><a href="#this-is-dynamic" class="headerlink" title="this is dynamic"></a>this is dynamic</h2><p>The this keywords value changes with a wide range of situations, such as if the code is executed at the top level, if you are using strict mode, and even the JavaScript spec of the browser (es3,es5,es2015+).</p>
<p>This is why I see code like this in many JavaScript modules.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> global = <span class="keyword">this</span> || (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span> ? <span class="built_in">window</span> : global);</div></pre></td></tr></table></figure>
<p>More on why that is later, but for now I thought I would start out by saying yes the this keyword is a little tricky. Once you think you have this all snuffed out you end up leaning more about it. </p>
<h2 id="At-the-top-level"><a href="#At-the-top-level" class="headerlink" title="At the top level"></a>At the top level</h2><p>It would seem that typically in most cases the this keyword refers to the global object at the top level when it is code that is executed at the top level. As far as I can tell it would appear that this is always the case. If the code is at the top level this will refer to whatever the global object is in the environment.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>; <span class="comment">// the global object</span></div></pre></td></tr></table></figure>
<h2 id="Inside-a-function"><a href="#Inside-a-function" class="headerlink" title="Inside a function."></a>Inside a function.</h2><p>This is where things can get a little confusing, as the this keyword can change depending on a lot of factors. I will cover as many of them as I am aware of here.</p>
<h2 id="An-es5-non-strict-mode-IIFE"><a href="#An-es5-non-strict-mode-IIFE" class="headerlink" title="An es5 (non strict mode) IIFE"></a>An es5 (non strict mode) IIFE</h2><p>If you use this inside an IIFE, and do not do anything to change the state of this by using call, apply, or the new keyword, then the this keyword will continue to do the same as when it is top level code.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">   <span class="built_in">console</span>.log(<span class="keyword">this</span>);  <span class="comment">// window (if in the browser)</span></div><div class="line"> </div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h2 id="An-ES5-strict-mode-IIFE"><a href="#An-ES5-strict-mode-IIFE" class="headerlink" title="An ES5 (strict mode) IIFE"></a>An ES5 (strict mode) IIFE</h2><p>Using ES5 javaScript strict mode will result in the this keyword having a value of undefined.</p>
<p>‘use strict’;<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">   <span class="built_in">console</span>.log(<span class="keyword">this</span>);  <span class="comment">// undefined</span></div><div class="line"> </div><div class="line">&#125;());</div></pre></td></tr></table></figure></p>
<p>This is why I see that expression that I mentioned earlier, sometimes getting the global object is not that easy when you are trying to design code that will work in any run time environment. As such you just have to use some conditionals.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"> </div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line"> <span class="built_in">console</span>.log(<span class="keyword">this</span> || (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span> ? <span class="built_in">window</span> : global));</div><div class="line"> </div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h2 id="The-new-keyword"><a href="#The-new-keyword" class="headerlink" title="The new keyword"></a>The new keyword</h2><p>The new keyword is used when calling a function to create a new instance of a constructor function. Writing something about constructors, Classes, and the prototype chain is outside the scope of this post. So I will just say that constructors come in handy when you want to make a whole bunch of objects that share a set of methods.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> global = <span class="keyword">this</span> || (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span> ? <span class="built_in">window</span> : global),</div><div class="line"> </div><div class="line">Foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">if</span>(<span class="keyword">this</span> === global)&#123;</div><div class="line"> </div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'you did not call Foo with the new keyword'</span>);</div><div class="line"> </div><div class="line">        <span class="keyword">return</span> &#123;&#125;;</div><div class="line"> </div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="keyword">this</span>.bar = <span class="string">'foo'</span>;</div><div class="line">    <span class="keyword">this</span>.now = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"> </div><div class="line">&#125;,</div><div class="line"> </div><div class="line">noNew = Foo(),</div><div class="line">yesNew = <span class="keyword">new</span> Foo();</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(noNew); <span class="comment">// just an Object</span></div><div class="line"><span class="built_in">console</span>.log(noNew.constructor.name); <span class="comment">// Object</span></div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(yesNew); <span class="comment">// An instance of Foo</span></div><div class="line"><span class="built_in">console</span>.log(yesNew.constructor.name); <span class="comment">// Foo</span></div></pre></td></tr></table></figure>
<p>If you just call Foo normally it will result in the global object or undefined like always, however if you call it with the new keyword it will return an object that is an instance of the Foo constructor.</p>
<h2 id="Using-call"><a href="#Using-call" class="headerlink" title="Using call"></a>Using call</h2><p>Call is a way that you can call a method on any object, regardless if it is an instance of it’s prototype or not. It works by changing the value of this to whatever object you give it.</p>
<p>One example of how this comes in handy is with instances of HTMLCollection. They are array like, but are not instances of the constructor Array, therefore they do not have methods such as Array.forEach. So one way to quickly loop over an HTMLCollection is to use call, and give the collection as the first argument.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> divs = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'div'</span>)</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(divs.constructor.name); <span class="comment">// HTMLCollection ( not Array )</span></div><div class="line"> </div><div class="line">[].forEach.call(divs,<span class="function"><span class="keyword">function</span>(<span class="params">div</span>)</span>&#123;</div><div class="line"> </div><div class="line">    <span class="built_in">console</span>.log(div);</div><div class="line"> </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>With call the first argument is the value you want this to be, and every argument after that is just the normal set of arguments that you would give to the method. In the case of Array.forEach it is the method I want called for each element of an array. </p>
<h2 id="Apply"><a href="#Apply" class="headerlink" title="Apply"></a>Apply</h2><p>Apply works in the same way as call only you give it just two arguments the second of which is an array of arguments that are to be used with the method you are using with Apply.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> divs = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'div'</span>);</div><div class="line"> </div><div class="line">[].slice.apply(divs,[<span class="number">1</span>,<span class="number">3</span>]).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">div</span>)</span>&#123;</div><div class="line"> </div><div class="line">    <span class="built_in">console</span>.log(div.innerHTML);</div><div class="line"> </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Here I am again using an Array method on an instance of HTMLCollection. in this case it is slice which returns an instance of Array that is a section from the HTMLCollection with the given index values in the array that I have given apply as the second argument.</p>
<p>I could use call in the same way like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[].slice.call(divs,<span class="number">1</span>,<span class="number">3</span>).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">div</span>)</span>&#123;</div><div class="line"> </div><div class="line">    <span class="built_in">console</span>.log(div.innerHTML);</div><div class="line"> </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Not all methods work though If I used Array.splice that would cause and error as the HTMLCollection instances are read only. Call, and Apply can be used anywhere where appropriate, including your own methods that are part of the Constructors that you define.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>So the this keyword is a little strange, hopefully this post will shed some light on the subject.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dustinpfister.github.io/2017/04/14/js-this-keyword/" data-id="cj1hy29kx000u6cv1m9nosds0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blog/">blog</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/corejs/">corejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2017/04/10/nodejs-jimp/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Node.js powered image processing thanks to Jimp.</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/api/">api</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/grunt/">grunt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node-js/">node.js</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/">SEO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/corejs/">corejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/games/">games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grunt/">grunt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jimp/">jimp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/structured-data/">structured-data</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JSON/" style="font-size: 10px;">JSON</a> <a href="/tags/SEO/" style="font-size: 10px;">SEO</a> <a href="/tags/automation/" style="font-size: 15px;">automation</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/corejs/" style="font-size: 10px;">corejs</a> <a href="/tags/games/" style="font-size: 12.5px;">games</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/jimp/" style="font-size: 10px;">jimp</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/node-js/" style="font-size: 17.5px;">node.js</a> <a href="/tags/structured-data/" style="font-size: 10px;">structured-data</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/04/14/js-this-keyword/">The this keyword.</a>
          </li>
        
          <li>
            <a href="/2017/04/10/nodejs-jimp/">Node.js powered image processing thanks to Jimp.</a>
          </li>
        
          <li>
            <a href="/2017/04/05/nodejs-helloworld/">node.js hello world</a>
          </li>
        
          <li>
            <a href="/2017/04/05/blog-volume-quality/">Blog Post volume.</a>
          </li>
        
          <li>
            <a href="/2017/03/29/nodejs-harp/">Node.js powered site generator Harp.</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Dustin Pfister<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/games" class="mobile-nav-link">Games</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>